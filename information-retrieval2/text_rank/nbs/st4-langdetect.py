#!/usr/bin/env python

# coding: utf-8

#------------------------------------------------------------------------------------------

#------------------------------------------------------------------------------------------

#------------------------------------------------------------------------------------------

from langdetect import detect

#------------------------------------------------------------------------------------------

import zlib

#------------------------------------------------------------------------------------------

from os import listdir
from os.path import isfile, join

#------------------------------------------------------------------------------------------

parsed_files = [
    join("../parsed/", f) for f in listdir("../parsed/")
    if isfile(join("../parsed/", f))
]

#------------------------------------------------------------------------------------------

from collections import defaultdict

#------------------------------------------------------------------------------------------

#------------------------------------------------------------------------------------------

import multiprocessing

#------------------------------------------------------------------------------------------

#------------------------------------------------------------------------------------------

from langdetect import detect, lang_detect_exception

#------------------------------------------------------------------------------------------

d = defaultdict(lambda: list())
for f in parsed_files[:1000]:
    with open(f) as fin:
        text = zlib.decompress(fin.read())
        try:
            d[detect(text.decode('utf-8')[:1000])].append(f)
        except lang_detect_exception:
            d[None].append(f)

#------------------------------------------------------------------------------------------

[(k, len(v)) for k, v in d.items()]

#------------------------------------------------------------------------------------------

detect(text.decode('utf-8')[:1000])

#------------------------------------------------------------------------------------------
